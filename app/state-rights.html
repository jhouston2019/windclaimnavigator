<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>State-Specific Rights &amp; Deadlines - Claim Navigator</title>
  <meta name="description" content="Get state-specific insurance claim rights, deadlines, and regulatory protections for your insurance claim.">
  <link rel="stylesheet" href="/app/assets/css/style.css">
  <link rel="stylesheet" href="/app/assets/css/design-system.css">
  <link rel="stylesheet" href="/app/assets/css/tool-visual-alignment.css">
  <script src="/app/assets/js/navigation-template.js"></script>
  
</head>
<body class="tool-page resource-center">
  <script>createNavigationBar('State Rights & Deadlines');</script>

  <section class="hero-section hero-navy">
    <div class="hero-content">
      <h1 data-en="State-Specific Rights & Deadlines" data-es="Derechos y Plazos Específicos del Estado">State-Specific Rights &amp; Deadlines</h1>
      <p class="subtitle" data-en="Your step-by-step guide from first notice to final settlement." data-es="Su guía paso a paso desde el primer aviso hasta el acuerdo final.">Your step-by-step guide from first notice to final settlement.</p>
    </div>
  </section>

  <main>
    <section class="page-section">
      <div class="frosted-card">
        <h2 data-en="Get state-specific protections" data-es="Obtenga protecciones específicas del estado">Get state-specific protections</h2>
        <p data-en="Select your state and claim type to view rights, deadlines, and regulatory protections. Results link to the full state guide." data-es="Seleccione su estado y tipo de reclamo para ver derechos, plazos y protecciones regulatorias. Los resultados enlazan a la guía completa del estado.">Select your state and claim type to view rights, deadlines, and regulatory protections. Results link to the full state guide.</p>
        <div class="form-stack">
          <form id="state-rights-form">
            <div class="form-group">
              <label for="state" data-en="U.S. State" data-es="Estado de EE.UU.">U.S. State <span>*</span></label>
              <select id="state" name="state" required class="input">
                <option value="" data-en="Select a state..." data-es="Seleccione un estado...">Select a state...</option>
                <option value="Alabama">Alabama</option>
                <option value="Alaska">Alaska</option>
                <option value="Arizona">Arizona</option>
                <option value="Arkansas">Arkansas</option>
                <option value="California">California</option>
                <option value="Colorado">Colorado</option>
                <option value="Connecticut">Connecticut</option>
                <option value="Delaware">Delaware</option>
                <option value="Florida">Florida</option>
                <option value="Georgia">Georgia</option>
                <option value="Hawaii">Hawaii</option>
                <option value="Idaho">Idaho</option>
                <option value="Illinois">Illinois</option>
                <option value="Indiana">Indiana</option>
                <option value="Iowa">Iowa</option>
                <option value="Kansas">Kansas</option>
                <option value="Kentucky">Kentucky</option>
                <option value="Louisiana">Louisiana</option>
                <option value="Maine">Maine</option>
                <option value="Maryland">Maryland</option>
                <option value="Massachusetts">Massachusetts</option>
                <option value="Michigan">Michigan</option>
                <option value="Minnesota">Minnesota</option>
                <option value="Mississippi">Mississippi</option>
                <option value="Missouri">Missouri</option>
                <option value="Montana">Montana</option>
                <option value="Nebraska">Nebraska</option>
                <option value="Nevada">Nevada</option>
                <option value="New Hampshire">New Hampshire</option>
                <option value="New Jersey">New Jersey</option>
                <option value="New Mexico">New Mexico</option>
                <option value="New York">New York</option>
                <option value="North Carolina">North Carolina</option>
                <option value="North Dakota">North Dakota</option>
                <option value="Ohio">Ohio</option>
                <option value="Oklahoma">Oklahoma</option>
                <option value="Oregon">Oregon</option>
                <option value="Pennsylvania">Pennsylvania</option>
                <option value="Rhode Island">Rhode Island</option>
                <option value="South Carolina">South Carolina</option>
                <option value="South Dakota">South Dakota</option>
                <option value="Tennessee">Tennessee</option>
                <option value="Texas">Texas</option>
                <option value="Utah">Utah</option>
                <option value="Vermont">Vermont</option>
                <option value="Virginia">Virginia</option>
                <option value="Washington">Washington</option>
                <option value="West Virginia">West Virginia</option>
                <option value="Wisconsin">Wisconsin</option>
                <option value="Wyoming">Wyoming</option>
              </select>
            </div>

            <div class="form-group">
              <label for="claimType" data-en="Claim Type" data-es="Tipo de Reclamo">Claim Type <span>*</span></label>
              <select id="claimType" name="claimType" required class="input">
                <option value="" data-en="Select claim type..." data-es="Seleccione tipo de reclamo...">Select claim type...</option>
                <option value="Property" data-en="Property" data-es="Propiedad">Property</option>
                <option value="Business Interruption" data-en="Business Interruption" data-es="Interrupción de Negocio">Business Interruption</option>
                <option value="Other" data-en="Other" data-es="Otro">Other</option>
              </select>
            </div>

            <div class="form-group">
              <label data-en="Language" data-es="Idioma">Language</label>
              <div class="form-inline">
                <label style="display:flex; align-items:center; gap:0.5rem;">
                  <input type="radio" name="language" value="en" checked>
                  <span data-en="English" data-es="Inglés">English</span>
                </label>
                <label style="display:flex; align-items:center; gap:0.5rem;">
                  <input type="radio" name="language" value="es">
                  <span data-en="Spanish" data-es="Español">Spanish</span>
                </label>
              </div>
            </div>

            <button type="submit" class="button primary" data-en="Get State Rights & Deadlines" data-es="Obtener Derechos y Plazos del Estado">Get State Rights &amp; Deadlines</button>
          </form>

          <div id="loading" class="loading" style="display:none;">
            <p data-en="Generating state-specific rights and deadlines..." data-es="Generando derechos y plazos específicos del estado...">Generating state-specific rights and deadlines...</p>
          </div>

          <div id="error" class="error"></div>

          <div id="output" class="output-panel">
            <div id="output-content"></div>
          </div>

          <p class="disclaimer">
            <strong data-en="Disclaimer:" data-es="Descargo de Responsabilidad:">Disclaimer:</strong>
            <span data-en="This information is AI-generated and may not reflect the latest law. Always consult with a qualified attorney for legal advice specific to your situation." 
                  data-es="Esta información es generada por IA y puede no reflejar la ley más reciente. Siempre consulte con un abogado calificado para obtener asesoría legal específica a su situación.">
              This information is AI-generated and may not reflect the latest law. Always consult with a qualified attorney for legal advice specific to your situation.
            </span>
          </p>
        </div>
      </div>
    </section>
  </main>

  <script>
    let currentLang = 'en';
    
    function toggleLanguage() {
      currentLang = currentLang === 'en' ? 'es' : 'en';
      document.documentElement.lang = currentLang;
      document.querySelectorAll('[data-en][data-es]').forEach(el => {
        const text = el.getAttribute(`data-${currentLang}`);
        if (text) {
          if (el.tagName === 'INPUT' || el.tagName === 'BUTTON') {
            el.textContent = text;
          } else {
            el.innerHTML = text;
          }
        }
      });
      document.title = currentLang === 'es' 
        ? 'Derechos y Plazos Específicos del Estado - Claim Navigator' 
        : 'State-Specific Rights & Deadlines - Claim Navigator';
      localStorage.setItem('preferredLanguage', currentLang);
    }
    
    document.addEventListener('DOMContentLoaded', () => {
      const savedLang = localStorage.getItem('preferredLanguage');
      if (savedLang === 'es') toggleLanguage();
    });

    document.getElementById('state-rights-form').addEventListener('submit', async (e) => {
      e.preventDefault();
      const formData = new FormData(e.target);
      const state = formData.get('state');
      const claimType = formData.get('claimType');
      const language = formData.get('language');

      if (!state || !claimType) {
        showError(currentLang === 'es' 
          ? 'Por favor, seleccione un estado y tipo de reclamo.' 
          : 'Please select a state and claim type.');
        return;
      }

      showLoading(); hideError(); hideOutput();

      try {
        const response = await fetch('/.netlify/functions/getStateRights', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${localStorage.getItem('supabase.auth.token')}`
          },
          body: JSON.stringify({ state, claimType, language })
        });

        const result = await response.json();

        if (response.ok) {
          const stateAbbrMap = {
            'Alabama': 'AL', 'Alaska': 'AK', 'Arizona': 'AZ', 'Arkansas': 'AR', 'California': 'CA',
            'Colorado': 'CO', 'Connecticut': 'CT', 'Delaware': 'DE', 'Florida': 'FL', 'Georgia': 'GA',
            'Hawaii': 'HI', 'Idaho': 'ID', 'Illinois': 'IL', 'Indiana': 'IN', 'Iowa': 'IA',
            'Kansas': 'KS', 'Kentucky': 'KY', 'Louisiana': 'LA', 'Maine': 'ME', 'Maryland': 'MD',
            'Massachusetts': 'MA', 'Michigan': 'MI', 'Minnesota': 'MN', 'Mississippi': 'MS', 'Missouri': 'MO',
            'Montana': 'MT', 'Nebraska': 'NE', 'Nevada': 'NV', 'New Hampshire': 'NH', 'New Jersey': 'NJ',
            'New Mexico': 'NM', 'New York': 'NY', 'North Carolina': 'NC', 'North Dakota': 'ND', 'Ohio': 'OH',
            'Oklahoma': 'OK', 'Oregon': 'OR', 'Pennsylvania': 'PA', 'Rhode Island': 'RI', 'South Carolina': 'SC',
            'South Dakota': 'SD', 'Tennessee': 'TN', 'Texas': 'TX', 'Utah': 'UT', 'Vermont': 'VT',
            'Virginia': 'VA', 'Washington': 'WA', 'West Virginia': 'WV', 'Wisconsin': 'WI', 'Wyoming': 'WY'
          };
          const stateAbbr = stateAbbrMap[state] || state.substring(0, 2).toUpperCase();
          const stateLink = `/app/resource-center/state/${stateAbbr}.html`;
          const contentDiv = document.getElementById('output-content');
          const linkHtml = `<br/><br/><a href="${stateLink}" style="color: #1e40af; text-decoration: underline; font-weight: 600;">View Complete ${state} Guide →</a>`;
          contentDiv.innerHTML = result.response.replace(/\n/g, '<br/>') + linkHtml;
          showOutput();
        } else {
          if (result.requiresUpgrade) {
            showError(currentLang === 'es' 
              ? 'Créditos insuficientes. Por favor, actualice su plan o compre créditos.' 
              : 'Insufficient credits. Please upgrade your plan or purchase credits.');
          } else {
            showError(result.error || (currentLang === 'es' 
              ? 'Error al generar la información. Inténtelo de nuevo.' 
              : 'Error generating information. Please try again.'));
          }
        }
      } catch (error) {
        console.error(error);
        showError(currentLang === 'es' 
          ? 'Error al procesar la solicitud. Inténtelo de nuevo.' 
          : 'Error processing the request. Please try again.');
      } finally {
        hideLoading();
      }
    });

    function showLoading() {
      document.getElementById('loading').style.display = 'block';
    }
    function hideLoading() {
      document.getElementById('loading').style.display = 'none';
    }
    function showError(message) {
      const errorDiv = document.getElementById('error');
      errorDiv.textContent = message;
      errorDiv.style.display = 'block';
    }
    function hideError() {
      document.getElementById('error').style.display = 'none';
    }
    function showOutput() {
      document.getElementById('output').style.display = 'block';
    }
    function hideOutput() {
      document.getElementById('output').style.display = 'none';
    }
  </script>
</body>
</html>


